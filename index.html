<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/blog/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="兄dei.你来了!">
<meta property="og:type" content="website">
<meta property="og:title" content="Yu！">
<meta property="og:url" content="http://yugeye.gitee.io/blog/index.html">
<meta property="og:site_name" content="Yu！">
<meta property="og:description" content="兄dei.你来了!">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Yu！">
<meta name="twitter:description" content="兄dei.你来了!">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":true,"transition":{"post_block":"slideLeftIn","post_header":"perspectiveRightIn","post_body":"slideDownIn","coll_header":"expandIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yugeye.gitee.io/blog/">





  <title>Yu！</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Yu！</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/blog/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/blog/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yugeye.gitee.io/blog/blog/2019/01/16/Vue-cli构建步骤/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YuGeYe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yu！">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2019/01/16/Vue-cli构建步骤/" itemprop="url">vue-cli构建步骤</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-16T12:55:05+08:00">
                2019-01-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Vue/" itemprop="url" rel="index">
                    <span itemprop="name">Vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><p>先确定使用哪个脚手架工具？ <strong>vue-cli 3.x</strong></p>
</li>
<li><p>初始化项目模板<br><code>vue create mobile-vux-demo</code></p>
</li>
<li><p>配置vux</p>
<p> 3.1 安装vux<br> <code>npm i vux -S</code></p>
<p> 3.2 安装vux-loader<br> <code>npm install vux-loader --save-dev</code></p>
<p> 3.3 安装less相关loader<br> <code>npm install less less-loader --save-dev</code></p>
</li>
<li><p>配置vux环境</p>
</li>
</ol>
<p><code>npm install vue-loader@14.2.2 -D</code></p>
<p>新建vue.config.js,在内部添加如下内容：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    configureWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">require</span>(<span class="string">'vux-loader'</span>).merge(config, &#123;</span><br><span class="line">            options: &#123;&#125;,</span><br><span class="line">            plugins: [<span class="string">'vux-ui'</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol start="5">
<li>使用</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; XHeader &#125; <span class="keyword">from</span> <span class="string">'vux'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    XHeader</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yugeye.gitee.io/blog/blog/2019/01/16/小程序-简单介绍/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YuGeYe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yu！">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2019/01/16/小程序-简单介绍/" itemprop="url">1.小程序-简单介绍</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-16T12:37:33+08:00">
                2019-01-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/小程序/" itemprop="url" rel="index">
                    <span itemprop="name">小程序</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="微信小程序开发-基础"><a href="#微信小程序开发-基础" class="headerlink" title="微信小程序开发-基础"></a>微信小程序开发-基础</h1><h2 id="今天知识点"><a href="#今天知识点" class="headerlink" title="今天知识点"></a>今天知识点</h2><p>1.什么是小程序<br>2.小程序和web网页的区别<br>3.小程序环境搭建<br>4.创建小程序<br>5.开发工具功能介绍<br>6.小程序的文件结构<br>7.小程序的组件<br>8.小程序样式<br>9.小程序生命周期</p>
<h2 id="1-什么是小程序"><a href="#1-什么是小程序" class="headerlink" title="1.什么是小程序"></a>1.什么是小程序</h2><p>小程序是一种不需要下载、安装即可使用的应用，它实现了触手可及的梦想，用户扫一扫或者搜一下就能打开应用，也实现了用完即走的理念，用户不用安装太多应用，应用随处可用，但又无须安装卸载</p>
<h2 id="2-小程序和web网页的区别"><a href="#2-小程序和web网页的区别" class="headerlink" title="2.小程序和web网页的区别"></a>2.小程序和web网页的区别</h2><p>小程序和网页是两个完全独立的东西，只是开发模式比较相似，都使用前端的开发技术</p>
<h2 id="3-小程序环境搭建"><a href="#3-小程序环境搭建" class="headerlink" title="3.小程序环境搭建"></a>3.小程序环境搭建</h2><h3 id="账号注册"><a href="#账号注册" class="headerlink" title="账号注册"></a>账号注册</h3><p>百度搜索 “微信公众平台”<br>官网地址： <a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener">https://mp.weixin.qq.com/</a><br>微信公众平台小程序注册地址：<a href="https://mp.weixin.qq.com/wxopen/waregister?action=step1&amp;token=&amp;lang=zh_CN" target="_blank" rel="noopener">https://mp.weixin.qq.com/wxopen/waregister?action=step1&amp;token=&amp;lang=zh_CN</a></p>
<p><strong>注册时主体类型选择</strong><br><img src="./images/QQ图片20180911090628.png" alt="QQ图片20180911090628"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意：注册小程序使用的邮箱账号不能和订阅号或者服务号的重复，也就是假如该邮箱账号注册过订阅号或者服务号，就不能用来注册小程序账号了，推荐注册一个新的邮箱账号，</span><br></pre></td></tr></table></figure>
<h2 id="4-创建小程序"><a href="#4-创建小程序" class="headerlink" title="4.创建小程序"></a>4.创建小程序</h2><p><strong>1.下载开发工具</strong><br>开发工具下载地址：<a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html</a></p>
<p><strong>2.获取appid</strong><br>小程序的appid相当于小程序平台的一个身份证，很多地方需要用到appid，比如在创建小程序项目时候就需要用到appid</p>
<p>1.登录微信公众开发平台（地址见账号注册）<br>2.进入设置<br>3.切换到开发设置<br><img src="./images/QQ图片20180910110644.png" alt=""></p>
<p><strong>3.创建第一个小程序项目</strong><br>打开微信开发者工具，根据下面提示填写项目信息<br><img src="./images/QQ图片20180910112151.png" alt=""></p>
<p>点击右下角的确定按钮，创建项目成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">总结：</span><br><span class="line">1. 账号注册，推荐使用新注册的邮箱，可以是163邮箱、新浪邮箱、qq邮箱等等</span><br><span class="line">2. 个人开发者，注册时第三选择账号主体要选择个人</span><br><span class="line">3. 获取appid，登录微信公众平台，选择左侧栏的设置，在右侧内容页切换到开发设置</span><br><span class="line">4. 创建项目时需要输入上一步获取的appid</span><br><span class="line">5. 选择启动模板： 选择快速启动模板</span><br></pre></td></tr></table></figure>
<h2 id="5-开发工具功能介绍"><a href="#5-开发工具功能介绍" class="headerlink" title="5.开发工具功能介绍"></a>5.开发工具功能介绍</h2><p><strong>1.新增和修改编译模式</strong><br>编译模式可以修改启动页和添加该页面的参数，新增界面如下图：</p>
<p><img src="./images/QQ图片20180910113810.png" alt=""></p>
<p>点击确定按钮，页面就会刷新并显示为当前设置的启动页</p>
<p><strong>2.预览和真机调试</strong><br>调试：开发者可以通过手机扫描预览提供的二维码来访问小程序<br>真机调试：和预览一样会提供访问的二维码，不同的是真机调试模式会弹出控制台，可以查看手机模式下的调试信息</p>
<p><strong>3.清除缓存</strong><br>清除本地的授权记录、sessionStorage和localStorage等缓存数据</p>
<p><strong>4.项目的详情设置</strong><br>通过顶部的菜单栏，选择 - 设置 - 项目设置，点击后有右侧打开项目设置面板<br><img src="./images/QQ图片20180910114910.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意版本库的选择，不要轻易去修改这个配置，很容易导致项目的api不兼容</span><br></pre></td></tr></table></figure>
<h2 id="6-小程序文件结构"><a href="#6-小程序文件结构" class="headerlink" title="6.小程序文件结构"></a>6.小程序文件结构</h2><h3 id="1-基本的结构"><a href="#1-基本的结构" class="headerlink" title="1.基本的结构"></a>1.基本的结构</h3><pre><code>- pages // 包含了所有页面
- index // 页面文件夹
    - index.js    // 页面的脚本逻辑文件
    - index.wxml  // 页面模板文件
    - index.wxss  // 页面样式文件
    - index.json  // 页面配置文件
- utils // 普通的工具函数
- app.js   // 项目启动入口
- app.json // 全局的配置
- app.wxss // 全局样式
- project.config.json // 项目的配置文件
</code></pre><p>和web的页面结构比较：</p>
<table>
<thead>
<tr>
<th>文件</th>
<th>小程序</th>
<th>web</th>
</tr>
</thead>
<tbody>
<tr>
<td>模板</td>
<td>.wxml</td>
<td>.html</td>
</tr>
<tr>
<td>样式</td>
<td>.wxss</td>
<td>.css</td>
</tr>
<tr>
<td>脚本</td>
<td>.js</td>
<td>.js/script标签</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意：微信小程序页面目录下，.js 和  .wxml 文件是必需的</span><br></pre></td></tr></table></figure>
<h3 id="2-全局配置-app-json"><a href="#2-全局配置-app-json" class="headerlink" title="2.全局配置 app.json"></a>2.全局配置 app.json</h3><p>app.json文件用来对微信小程序进行全局配置</p>
<p><strong>常见的属性：</strong><br>| 属性 | 类型 | 必填 | 描述 | 详细配置地址 |<br>| —- | —- | —- | —- | —- |<br>| pages | String | 是 | 页面路径列表 | <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/config.html#pages" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/config.html#pages</a> |<br>| window | Object | 否 | 全局的窗口样式 | <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/config.html#window" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/config.html#window</a> |<br>| tabBar | Object | 否 | 底部tab栏的配置 | <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/config.html#tabBar" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/config.html#tabBar</a> |</p>
<p><strong>局部配置</strong></p>
<p>pages数组中的页面路径地址必须存在pages文件夹中</p>
<p>pages数组中的页面路径地址下标为0，也就是第一个路径在普通编译模式下会作为启动页面，但不建议使用更换顺序的方式修改启动页， 可以通过新增或修改编译模式更改启动页</p>
<p><strong>window配置示例</strong></p>
<pre><code>// app.json
{
  &quot;window&quot;:{
    &quot;navigationBarBackgroundColor&quot;: &quot;#fff&quot;, // 导航栏背景颜色 
    &quot;navigationBarTextStyle&quot;: &quot;black&quot;,      // 导航栏标题颜色，仅支持 black / white
    &quot;navigationBarTitleText&quot;: &quot;weChart&quot;,    // 导航栏标题文字内容
    &quot;backgroundColor&quot;: &quot;#fff&quot;,                // 窗口的背景色
    &quot;backgroundTextStyle&quot;: &quot;light&quot;，            // 下拉 loading 的样式，仅支持 dark / light
    &quot;enablePullDownRefresh&quot;: true            // 设置允许下拉刷新
  }
}
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">注意： window的配置</span><br><span class="line">1. navigationBarTextStyle导航栏标题颜色，仅支持 black / white </span><br><span class="line">2. backgroundTextStyle下拉 loading 的样式，仅支持 dark / light</span><br></pre></td></tr></table></figure>
<p><strong>tabBar配置示例</strong></p>
<pre><code>// app.json
{
  &quot;tabBar&quot;: {
      &quot;color&quot;: &quot;#000&quot;,                    // tab 上的文字默认颜色
      &quot;selectedColor&quot;: &quot;#000&quot;,            // tab 上的文字选中时的颜色
      &quot;backgroundColor&quot;: &quot;#f5f5f5&quot;,        // tab 的背景色
    &quot;list&quot;: [{
      &quot;pagePath&quot;: &quot;pages/index/index&quot;,    // 页面路径，必须在 pages 中先定义（必填）
      &quot;text&quot;: &quot;首页&quot;,                    // tab 上按钮文字（必填）
      &quot;iconPath&quot;: &quot;&quot;,                    // tab 上的图片路径,不支持网络图片
      &quot;selectedIconPath&quot;: &quot;&quot;            // 选中时的图片路径
    }, {
      &quot;pagePath&quot;: &quot;pages/logs/logs&quot;,
      &quot;text&quot;: &quot;日志&quot;,
      &quot;iconPath&quot;: &quot;&quot;,                    
      &quot;selectedIconPath&quot;: &quot;&quot;        
    }]
  }
}
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意：配置了tabBar后，底部栏只对配置的页面可见, 而且tabBar的设置至少两个，最多5个</span><br></pre></td></tr></table></figure>
<h3 id="3-页面配置"><a href="#3-页面配置" class="headerlink" title="3.页面配置"></a>3.页面配置</h3><p>每一个小程序页面也可以使用.json文件来对本页面的窗口表现进行配置。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意：页面的配置只能设置 app.json 中部分 window 配置项的内容，页面中配置项会覆盖 app.json 的 window 中相同的配置项。</span><br></pre></td></tr></table></figure></p>
<h2 id="7-小程序的组件"><a href="#7-小程序的组件" class="headerlink" title="7.小程序的组件"></a>7.小程序的组件</h2><h3 id="新建页面"><a href="#新建页面" class="headerlink" title="新建页面"></a>新建页面</h3><p>通过app.json来新建</p>
<h3 id="wxml和html的不同点"><a href="#wxml和html的不同点" class="headerlink" title="wxml和html的不同点"></a>wxml和html的不同点</h3><p>标签名字不一样，如html里常用的标签 div、section, article, a、span等，在小程序里标签是view、navigator、text等</p>
<h3 id="view容器组件"><a href="#view容器组件" class="headerlink" title="view容器组件"></a>view容器组件</h3><p>view组价的基本使用<br>    <view class="container"><br>        <!-- 页面内容 --><br>    </view></p>
<h3 id="text文本组件"><a href="#text文本组件" class="headerlink" title="text文本组件"></a>text文本组件</h3><p>text的基本使用<br>    <view class="container"><br>        <!-- text组件 --><br>        <text>文本内容</text><br>    </view></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. text组件内只支持 text 嵌套</span><br><span class="line">2. 除了文本节点以外的其他节点都无法长按选中</span><br></pre></td></tr></table></figure>
<h3 id="navigator页面链接组件"><a href="#navigator页面链接组件" class="headerlink" title="navigator页面链接组件"></a>navigator页面链接组件</h3><p>navigator的基本使用<br>    // url的连接前面必须加上斜杆 “/”<br>    <navigator url="/pages/demo/domo"><br>        跳转到demo<br>    </navigator></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意：navigator不支持跳转到外部的url，例如url=&quot;https://www.baidu.com&quot;</span><br></pre></td></tr></table></figure>
<p><strong>跳转到tabBar的页面</strong><br>设置open-type值为switchTab，比如index页面是tabBar的页面，可以这样来设置</p>
<p>跳转到tabBar的使用方法</p>
<pre><code>&lt;navigator url=&quot;/pages/index/index&quot; open-type=&quot;switchTab&quot;&gt;
    跳转到首页
&lt;/navigator&gt;
</code></pre><h3 id="image图片组件"><a href="#image图片组件" class="headerlink" title="image图片组件"></a>image图片组件</h3><p>image的基本使用</p>
<pre><code>&lt;image 
    style=&quot;width: 200px; height: 200px;
    mode=&quot;aspectFill&quot; 
    src=&quot;图片地址&quot;&gt;
&lt;/image&gt;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意：image组件默认宽度300px、高度240px 注2：image组件中二维码/小程序码图片不支持长按识别</span><br></pre></td></tr></table></figure>
<p>图片的裁剪模式</p>
<p><strong>常用的mode 有效值</strong></p>
<ul>
<li>scaleToFill    不保持纵横比缩放图片，使图片的宽高完全拉伸至填满 image 元素<br>   aspectFit        保持纵横比缩放图片，使图片的长边能完全显示出来<br>   aspectFill    保持纵横比缩放图片，只保证图片的短边能完全显示出来</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意：微信朋友圈和QQ的说说页的图片裁剪方式，可以通过设置 `mode=aspectFill` 实现类似功能</span><br></pre></td></tr></table></figure>
<h3 id="input组件"><a href="#input组件" class="headerlink" title="input组件"></a>input组件</h3><p>input的简单使用<br>    <input placeholder="请输入文字" type="text"></p>
<p><strong>input常用的属性</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>String</td>
<td></td>
<td>输入框的初始内容</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>“text”</td>
<td>input 的类型</td>
</tr>
<tr>
<td>password</td>
<td>Boolean</td>
<td>false</td>
<td>是否是密码类型</td>
</tr>
<tr>
<td>placeholder</td>
<td>String</td>
<td></td>
<td>输入框为空时占位符</td>
</tr>
<tr>
<td>disabled</td>
<td>Boolean</td>
<td>false</td>
<td>是否禁用</td>
</tr>
</tbody>
</table>
<p><strong>input type 有效值</strong><br>| 值 | 说明 |<br>| —- | —- |<br>| text | 文本输入键盘 |<br>| number | 数字输入键盘 |<br>| idcard | 身份证输入键盘 |<br>| digit | 带小数点的数字键盘 |</p>
<h3 id="button-按钮组件"><a href="#button-按钮组件" class="headerlink" title="button 按钮组件"></a>button 按钮组件</h3><p><strong>button常用的属性</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>size</td>
<td>String</td>
<td>default</td>
<td>按钮的大小</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>default</td>
<td>按钮的样式类型</td>
</tr>
<tr>
<td>disabled</td>
<td>Boolean</td>
<td>false</td>
<td>是否禁用</td>
</tr>
<tr>
<td>loading</td>
<td>Boolean</td>
<td>false</td>
<td>名称前是否带 loading 图标</td>
</tr>
<tr>
<td>form-type</td>
<td>String</td>
<td></td>
<td>用于form组件，可选值 submit/reset，触发form的提交和reset事件</td>
</tr>
</tbody>
</table>
<h3 id="form表单组件"><a href="#form表单组件" class="headerlink" title="form表单组件"></a>form表单组件</h3><p>form表单基本提交案例</p>
<p>第一步，设置button form-type=’submit </p>
<p>第二步，通过bindsubmit设置form的提交事件处理函数 </p>
<pre><code>// wxml
&lt;form bindsubmit=&quot;formSubmit&quot;&gt;
    &lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder&gt;&lt;/input&gt;
    &lt;button form-type=&quot;submit&quot;&gt;提交&lt;/button&gt;
&lt;/form&gt;

// js
formSubmit: function(e){
    console.log(e.detail.value)
}
</code></pre><h2 id="8-小程序样式"><a href="#8-小程序样式" class="headerlink" title="8.小程序样式"></a>8.小程序样式</h2><p>WXSS 对 CSS 进行了扩充以及修改，与 CSS 相比，WXSS 扩展的特性有：</p>
<ul>
<li>全局样式和局部样式</li>
<li>尺寸单位</li>
<li>样式导入</li>
</ul>
<h3 id="1-全局样式和局部样式"><a href="#1-全局样式和局部样式" class="headerlink" title="1.全局样式和局部样式"></a>1.全局样式和局部样式</h3><p>app.wxss是全局样式,page中的wxss是页面的局部样式</p>
<h3 id="2-rpx-尺寸单位"><a href="#2-rpx-尺寸单位" class="headerlink" title="2.rpx 尺寸单位"></a>2.rpx 尺寸单位</h3><p><strong>什么是rpx？</strong><br>rpx可以使元素根据屏幕宽度进行自适应，小程序规定屏幕的宽度为750rpx， 也就是 100% = 750rpx; 50% = (750 / 2)rpx</p>
<p><strong>其他自适应方法</strong><br>web中使用rem，vw, vh, 百分比</p>
<p><strong>使用方法</strong><br>在开发小程序是建议使用750像素宽度的设计稿，这样设计稿的元素宽度是多少像素就直接设置为多少rpx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意1rpx在某些屏幕上可能无效</span><br></pre></td></tr></table></figure>
<h3 id="3-样式导入"><a href="#3-样式导入" class="headerlink" title="3.样式导入"></a>3.样式导入</h3><p>通过<code>@import</code>导入外部的样式，常用语公共样式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">总结：</span><br><span class="line">1.wxss 不需要导入到wxml，在页面目录下创建即可生效</span><br><span class="line">2.app.wxss是全局样式,page中的wxss是页面的局部样式</span><br><span class="line">3.rpx 尺寸单位 </span><br><span class="line">4.@import 样式导入</span><br></pre></td></tr></table></figure>
<h2 id="9-小程序生命周期"><a href="#9-小程序生命周期" class="headerlink" title="9.小程序生命周期"></a>9.小程序生命周期</h2><p>生命周期有程序的生命周期和页面的生命周期</p>
<h3 id="1-程序的生命周期"><a href="#1-程序的生命周期" class="headerlink" title="1.程序的生命周期"></a>1.程序的生命周期</h3><p>文档地址：<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/app.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/app.html</a></p>
<p>在程序入口<code>app.js</code>中调用App(),    而且必须调用且只能调用一次，然后再App()的参数中可以声明生命周期函数</p>
<p><strong>前台，后台的概念</strong></p>
<ul>
<li>前台：打开微信就进入小程序前台</li>
<li>后台：当用户点击右上角关闭，或者按了设备 Home 键离开微信，此时小程序并没有直接销毁，而是进入了后台；</li>
</ul>
<p><strong>常用的生命周期：</strong><br>| 属性 | 描述 | 触发时机 |<br>| —- | —- | ——– |<br>| onLaunch | 监听小程序初始化 | 小程序初始化完成时（全局只触发一次）|<br>| onShow | 监听小程序显示 | 小程序启动，或从后台进入前台显示时 |<br>| onHide | 监听小程序隐藏 | 小程序从前台进入后台时 |</p>
<p><strong>注意：小程序的运行机制</strong></p>
<ul>
<li>小程序没有重启的概念</li>
<li>当小程序进入后台，客户端会维持一段时间的运行状态，超过一定时间后（目前是5分钟）会被微信主动销毁</li>
</ul>
<h3 id="2-页面的生命周期"><a href="#2-页面的生命周期" class="headerlink" title="2.页面的生命周期"></a>2.页面的生命周期</h3><p>页面需要通过Page(Object) 函数用来注册一个页面。接受一个 Object 类型参数，其指定页面的初始数据、生命周期回调、事件处理函数等。</p>
<p>文档地址：<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html</a></p>
<p><strong>常用的生命周期：</strong><br>| 属性 | 描述 |<br>| onLoad | 监听页面加载 |<br>| onShow | 监听页面显示 |<br>| onReady | 监听页面初次渲染完成 |<br>| onHide | 监听页面隐藏 |</p>
<p><strong>onLoad</strong><br>页面加载时触发。一个页面只会调用一次，可以在 onLoad 的参数中获取打开当前页面路径中的参数。</p>
<p>参数说明, 通过query获取当前页面路径中的参数</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>Object</td>
<td>打开当前页面路径中的参数</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意：页面需要访问api接口来初始化页面， 都可以在onLoad中调用</span><br></pre></td></tr></table></figure>
<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><ul>
<li>程序的生命周期: app.js中onLaunch在小程序初始化中触发</li>
<li>页面的生命周期: onLoad 只在页面加载的时候执行一次, onShow每次访问页面都会执行, 通常onLoad在onShow之前执行</li>
</ul>
<h2 id="今天总结："><a href="#今天总结：" class="headerlink" title="今天总结："></a>今天总结：</h2><p>1.小程序和web网页的区别<br>2.小程序环境搭建<br>3.创建小程序<br>4.开发工具功能介绍<br>5.小程序的文件结构<br>6.小程序的组件<br>7.小程序样式<br>8.小程序生命周期</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yugeye.gitee.io/blog/blog/2019/01/16/小程序-购物车、选中状态、商品数量/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YuGeYe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yu！">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2019/01/16/小程序-购物车、选中状态、商品数量/" itemprop="url">小程序-promise封装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-16T12:33:36+08:00">
                2019-01-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/小程序/" itemprop="url" rel="index">
                    <span itemprop="name">小程序</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="购物车"><a href="#购物车" class="headerlink" title="购物车"></a>购物车</h1><h2 id="获取收货地址"><a href="#获取收货地址" class="headerlink" title="获取收货地址"></a>获取收货地址</h2><p>使用小程序api  wx.chooseAddress调用原生的界面获取收获地址，这个api需要用户授权,返回信息列表参考文档</p>
<p><a href="https://developers.weixin.qq.com/miniprogram/dev/api/wx.chooseAddress.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/api/wx.chooseAddress.html</a></p>
<h2 id="1-把商品加入到购物车"><a href="#1-把商品加入到购物车" class="headerlink" title="1.把商品加入到购物车"></a>1.把商品加入到购物车</h2><p>1.1 在商品详情页把当前商品添加到本地存储</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 添加到购物车</span><br><span class="line">handleAddCart()&#123;</span><br><span class="line">    // 如果本地没有数据，设置为空的对象</span><br><span class="line">    let cartList = wx.getStorageSync(&quot;goods&quot;) || &#123;&#125;;</span><br><span class="line">    cartList[this.detail.goods_id] = this.detail;</span><br><span class="line">    // 把cartList存储到本地</span><br><span class="line">    wx.setStorageSync(&quot;goods&quot;, cartList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>为什么商品列表使用对象，而不是使用数组？</p>
<p>因为查找数组的元素必须要通过循环，如果使用对象直接把goods_id作为对象的key，以后需要查找该元素时候直接通过对象goods_id找到</p>
<p>1.2 计算总价格:</p>
<p>通过computed监听goods列表，再循环该列表把价格</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> // 总价格</span><br><span class="line">allPrice()&#123;</span><br><span class="line"> 	let price = 0;</span><br><span class="line"></span><br><span class="line">	// 通过循环计算总价格</span><br><span class="line">	Object.keys(this.goods).forEach(v =&gt; &#123;</span><br><span class="line">		price += +this.goods[v].goods_price;</span><br><span class="line">	&#125;)</span><br><span class="line">	return price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意：通过Object.key()循环对象小技巧</p>
<h2 id="2-修改商品的数量"><a href="#2-修改商品的数量" class="headerlink" title="2.修改商品的数量"></a>2.修改商品的数量</h2><p>当商品数量减1时候，需要当前数量是否为1，如果为1，需要通过 <code>wx.showModal</code>提示用户是否删除该商品，</p>
<p>如果确认删除，通过<code>delete</code>关键字删除商品对象下需要删除的商品</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// 商品数量减1</span><br><span class="line">handleDecrease(item)&#123;</span><br><span class="line">	const id = item.goods_id;</span><br><span class="line"></span><br><span class="line">	if(this.goods[id].num === 1)&#123;</span><br><span class="line">		// 删除商品</span><br><span class="line">		wx.showModal(&#123;</span><br><span class="line">            title: &apos;提示&apos;,</span><br><span class="line">            content: &apos;是否删除？&apos;,</span><br><span class="line">            success: res =&gt; &#123;</span><br><span class="line">            if (res.confirm) &#123;</span><br><span class="line">            delete this.goods[id]; </span><br><span class="line">            wx.setStorageSync(&quot;goods&quot;, this.goods);</span><br><span class="line">            &#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	&#125;else&#123;</span><br><span class="line">        this.goods[id].num -= 1;</span><br><span class="line">        wx.setStorageSync(&quot;goods&quot;, this.goods);</span><br><span class="line">	&#125; </span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="3-修改商品的选中状态"><a href="#3-修改商品的选中状态" class="headerlink" title="3.修改商品的选中状态"></a>3.修改商品的选中状态</h2><h3 id="3-1-修改单个商品的状态"><a href="#3-1-修改单个商品的状态" class="headerlink" title="3.1 修改单个商品的状态"></a>3.1 修改单个商品的状态</h3><p>通过事件参数获取到需要修改的商品，拿到该商品后把状态值取反</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 修改单个商品的状态</span><br><span class="line">handleSelected(item)&#123;</span><br><span class="line">	const id = item.goods_id;</span><br><span class="line">	// 状态值取反</span><br><span class="line">	this.goods[id].selected = !this.goods[id].selected;</span><br><span class="line">	wx.setStorageSync(&quot;goods&quot;, this.goods);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h3 id="3-2-修改全部商品的状态"><a href="#3-2-修改全部商品的状态" class="headerlink" title="3.2 修改全部商品的状态"></a>3.2 修改全部商品的状态</h3><p>先在computed计算全部商品的状态， 只要其中有一个商品是没选中，认为当前全选状态为false</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 全选状态</span><br><span class="line">allSelected()&#123;</span><br><span class="line">	let select = true;</span><br><span class="line">	// 只要有一个元素没选中， 那么全选就为false</span><br><span class="line">	Object.keys(this.goods).forEach(v =&gt; &#123;</span><br><span class="line">		if(!this.goods[v].selected)&#123;</span><br><span class="line">		select = false;</span><br><span class="line">	&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">	return select;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当点击时候触发，通过当前的全选状态全部取反</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 全选取反</span><br><span class="line">handleAllSelected()&#123;</span><br><span class="line">	let select = !this.allSelected;</span><br><span class="line">	Object.keys(this.goods).forEach(v =&gt; &#123;</span><br><span class="line">		this.goods[v].selected = select;</span><br><span class="line">	&#125;);</span><br><span class="line">	wx.setStorageSync(&quot;goods&quot;, this.goods);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>##4.计算总价格</p>
<p>在计算总价格时候需要判断一些条件，只有当商品选中的时候，可以把当前的单价乘以数量的值再相加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// 总价格</span><br><span class="line">allPrice()&#123;</span><br><span class="line">	let price = 0;</span><br><span class="line"></span><br><span class="line">	// 通过循环计算总价格</span><br><span class="line">	Object.keys(this.goods).forEach(v =&gt; &#123;</span><br><span class="line">        // 只有当商品选中时候才价格相加</span><br><span class="line">        if(this.goods[v].selected)&#123;</span><br><span class="line">            // +号可以强制把字符串转化为数字</span><br><span class="line">            // 商品价格等于单价乘以数量</span><br><span class="line">            price += +this.goods[v].goods_price * 		this.goods[v].num;</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;);</span><br><span class="line">	return price;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="5-拼接创建订单的参数"><a href="#5-拼接创建订单的参数" class="headerlink" title="5. 拼接创建订单的参数"></a>5. 拼接创建订单的参数</h2><p>使用数据的map方法返回所需要的goods参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 通过map循环返回新的数组，数组的元素是由return返回的</span><br><span class="line">data.goods = Object.keys(this.goods).map(v =&gt; &#123;</span><br><span class="line">	return &#123;</span><br><span class="line">    	goods_id: this.goods[v].goods_id,</span><br><span class="line">    	goods_number: this.goods[v].num,</span><br><span class="line">    	goods_price: this.goods[v].goods_price</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yugeye.gitee.io/blog/blog/2019/01/16/小程序-订单、用户授权/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YuGeYe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yu！">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2019/01/16/小程序-订单、用户授权/" itemprop="url">小程序-订单、用户授权</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-16T12:33:32+08:00">
                2019-01-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/小程序/" itemprop="url" rel="index">
                    <span itemprop="name">小程序</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="修改购物车bug"><a href="#修改购物车bug" class="headerlink" title="修改购物车bug"></a>修改购物车bug</h1><p>点击选择状态和加减数量页面数组不变，本地的数据发生了变化</p>
<p>原因是MPVUE存在的bug，在vuejs中不会出现</p>
<p>解决方案：</p>
<p>1.删除dist，重新npm run dev</p>
<p>2.修改点击状态的事件和加减数量的事件, 把商品列表重新赋值为一个全新的对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// 修改单个商品的状态</span><br><span class="line">handleSelected(item)&#123;</span><br><span class="line">	// 创建一个全新的list对象</span><br><span class="line">	let list = &#123;&#125;</span><br><span class="line">	// 循环goods</span><br><span class="line">	Object.keys(this.goods).forEach(v =&gt; &#123;</span><br><span class="line">		// 如果goods_id相等</span><br><span class="line">		if(v == item.goods_id)&#123;</span><br><span class="line">			// 状态值取反，解构一个新的对象给当前对象</span><br><span class="line">            list[v] = &#123; </span><br><span class="line">            	...this.goods[v],</span><br><span class="line">            	selected: !this.goods[v].selected</span><br><span class="line">            &#125;</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			list[v] = this.goods[v];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">    // 把这个全新的list对象赋值给this.goods列表</span><br><span class="line">    this.goods = list;</span><br><span class="line">    // 保存到本都</span><br><span class="line">    wx.setStorageSync(&quot;goods&quot;, this.goods);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="创建订单"><a href="#创建订单" class="headerlink" title="创建订单"></a>创建订单</h2><p>先拼接订单的参数</p>
<p>注意goods数组列表的生成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 订单需要的参数</span><br><span class="line">let data = &#123;</span><br><span class="line">    order_price: this.allPrice,</span><br><span class="line">    consignee_addr: this.address.addr,</span><br><span class="line">    goods: []</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 通过map循环返回新的数组，数组的元素是由return返回的</span><br><span class="line">Object.keys(this.goods).forEach(v =&gt; &#123;</span><br><span class="line">	// 只选择状态选中的商品</span><br><span class="line">    if( this.goods[v].selected)&#123;</span><br><span class="line">    	data.goods.push(&#123;</span><br><span class="line">            goods_id: this.goods[v].goods_id,</span><br><span class="line">            goods_number: this.goods[v].num,</span><br><span class="line">            goods_price: +this.goods[v].goods_price</span><br><span class="line">    	&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="判断用户本地是否有token"><a href="#判断用户本地是否有token" class="headerlink" title="判断用户本地是否有token"></a>判断用户本地是否有token</h2><p>判断用户本地是否有token， 如果没有跳转到授权登录页，如果有就创建订单</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 需要授权访问的请求</span><br><span class="line">request.auth = function(url, data)&#123;</span><br><span class="line"></span><br><span class="line">    // 从本地获取token</span><br><span class="line">    if(!wx.getStorageSync(&quot;token&quot;))&#123;</span><br><span class="line">        wx.navigateTo(&#123;</span><br><span class="line">            url: &quot;/pages/auth/main&quot;</span><br><span class="line">        &#125;);</span><br><span class="line">        return new Promise(() =&gt; &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 返回promise</span><br><span class="line">    // 注意，第四个参数是header头信息</span><br><span class="line">    return request(url, &quot;POST&quot;, data, &#123;</span><br><span class="line">        &quot;Authorization&quot; : wx.getStorageSync(&quot;token&quot;)</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="用户授权登录，获取用户信息"><a href="#用户授权登录，获取用户信息" class="headerlink" title="用户授权登录，获取用户信息"></a>用户授权登录，获取用户信息</h2><p>获取用户授权的几种方法</p>
<p><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/authorize.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/authorize.html</a></p>
<p><img src="images\1547361241366.png" alt="1547361241366"></p>
<p>使用button发起用户授权</p>
<p><img src="images\1547361316738.png" alt="1547361316738"></p>
<p>使用示例 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;button open-type=&quot;getUserInfo&quot; lang=&quot;zh_CN&quot; bindgetuserinfo=&quot;onGotUserInfo&quot;&gt;</span><br><span class="line">  获取用户信息</span><br><span class="line">&lt;/button&gt;</span><br></pre></td></tr></table></figure>
<h2 id="发起订单支付"><a href="#发起订单支付" class="headerlink" title="发起订单支付"></a>发起订单支付</h2><p>在创建订单接口获取到订单编号,通过订单编号发起订单支付</p>
<p>注意： 后台复制返回订单的支付信息, 前端使用订单的支付信息通过wx.reqeustPayment()调用订单支付的窗口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// 发起支付</span><br><span class="line">handlePay()&#123;   	request.auth(&quot;https://itjustfun.cn/api/public/v1/my/orders/req_unifiedorder&quot;, &#123;</span><br><span class="line">        &quot;order_number&quot;: this.order_number</span><br><span class="line">      &#125;).then(res =&gt; &#123;</span><br><span class="line">        // 获取订单支付信息</span><br><span class="line">        const &#123;wxorder&#125; = res.data.data;</span><br><span class="line">        // 调用微信支付窗口</span><br><span class="line">        wx.requestPayment(&#123;</span><br><span class="line">          ...wxorder,</span><br><span class="line">          success: () =&gt; &#123;</span><br><span class="line">            // 返回上一页</span><br><span class="line">            wx.navigateBack(&#123;</span><br><span class="line">              delta: 1</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // 删除本地的提交过的商品</span><br><span class="line">        Object.keys(this.goods).forEach(v =&gt; &#123;</span><br><span class="line">          if(this.goods[v].selected)&#123;</span><br><span class="line">            delete this.goods[v];</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        wx.setStorageSync(&quot;goods&quot;, this.goods);</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="下拉刷新"><a href="#下拉刷新" class="headerlink" title="下拉刷新"></a>下拉刷新</h2><p>在需要下拉刷新的页面配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;enablePullDownRefresh&quot;: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>页面可以用过页面事件 onPullDownRefresh 监听页面的下拉</p>
<p><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html#%E9%A1%B5%E9%9D%A2%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html#%E9%A1%B5%E9%9D%A2%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0</a></p>
<h2 id="获取用户头像和昵称"><a href="#获取用户头像和昵称" class="headerlink" title="获取用户头像和昵称"></a>获取用户头像和昵称</h2><p>1.通过getuserinfo API授权获取</p>
<p>2.通过open-data标签获取</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 如果只是展示用户头像昵称，可以使用 &lt;open-data /&gt; 组件 --&gt;</span><br><span class="line">&lt;open-data type=&quot;userAvatarUrl&quot;&gt;&lt;/open-data&gt;</span><br><span class="line">&lt;open-data type=&quot;userNickName&quot;&gt;&lt;/open-data&gt;</span><br><span class="line">&lt;!-- 需要使用 button 来授权登录 --&gt;</span><br><span class="line">&lt;button</span><br><span class="line">  wx:if=&quot;&#123;&#123;canIUse&#125;&#125;&quot;</span><br><span class="line">  open-type=&quot;getUserInfo&quot;</span><br><span class="line">  bindgetuserinfo=&quot;bindGetUserInfo&quot;</span><br><span class="line">&gt;</span><br><span class="line">  授权登录</span><br><span class="line">&lt;/button&gt;</span><br><span class="line">&lt;view wx:else&gt;请升级微信版本&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<p><a href="https://developers.weixin.qq.com/miniprogram/dev/api/wx.getUserInfo.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/api/wx.getUserInfo.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yugeye.gitee.io/blog/blog/2019/01/16/小程序-promise封装/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YuGeYe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yu！">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2019/01/16/小程序-promise封装/" itemprop="url">小程序-promise封装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-16T12:33:29+08:00">
                2019-01-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/小程序/" itemprop="url" rel="index">
                    <span itemprop="name">小程序</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#小程序-2</p>
<h2 id="1-Promise封装"><a href="#1-Promise封装" class="headerlink" title="1.Promise封装"></a>1.Promise封装</h2><p>通常使用promise解决函数嵌套, 当你一个函数需要接受多个函数作为参数时候，并且是异步处理，那么可以考虑实用promise, 当前解决办法并不是唯一的(可以了解下thunk函数)</p>
<p><img src="images\1546996092614.png" alt=""></p>
<p><img src="images\1546996791846.png" alt=""></p>
<h2 id="2-固定伸缩性布局子元素的宽度"><a href="#2-固定伸缩性布局子元素的宽度" class="headerlink" title="2. 固定伸缩性布局子元素的宽度"></a>2. 固定伸缩性布局子元素的宽度</h2><p>当父元素为display:flex;布局时，如果子元素的内容宽度超出会挤压另一侧的内容宽度，导致另一侧的宽度不生效，这时可以设置子元素的css属性为：</p>
<p>flex-shrink: 0; </p>
<h2 id="3-使元素宽度撑开整个屏幕的高度"><a href="#3-使元素宽度撑开整个屏幕的高度" class="headerlink" title="3.使元素宽度撑开整个屏幕的高度"></a>3.使元素宽度撑开整个屏幕的高度</h2><p>在需要div元素撑开整个屏幕高度的时候，可以把元素定位为固定定位或者绝对定位，然后同时设置top值bottom值，那么这两个值之间的距离就是元素高度（同理也可以同时设置left和right）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.content&#123;</span><br><span class="line">    position: fixed;</span><br><span class="line">    left:0;</span><br><span class="line">    right:0;</span><br><span class="line">    top:100rpx; </span><br><span class="line">    bottom:0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-小程序获取参数"><a href="#4-小程序获取参数" class="headerlink" title="4. 小程序获取参数"></a>4. 小程序获取参数</h2><p>###4.1 在navigator连接里面添加路径参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;navigator :url=&quot;&apos;/pages/search_list/main?keyword=&apos; + 参数值&quot;&gt; &lt;/navigator&gt;</span><br></pre></td></tr></table></figure>
<p>###4.2 在打开的页面获取路径中的参数</p>
<p>在小程序的生命周期函数onLoad里面获取路径的参数</p>
<p>文档地址<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0</a></p>
<p>注意： 在mpvue里面，小程序的生命周期和vue的生命周期可以同时使用</p>
<h2 id="5-页面上拉触底时候触发页面事件"><a href="#5-页面上拉触底时候触发页面事件" class="headerlink" title="5. 页面上拉触底时候触发页面事件"></a>5. 页面上拉触底时候触发页面事件</h2><p>会触发onReachBottom，和onLoad是同级的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//  页面触底时候触发</span><br><span class="line">onReachBottom()&#123;</span><br><span class="line">	console.log(123)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-分页数据拼接"><a href="#6-分页数据拼接" class="headerlink" title="6. 分页数据拼接"></a>6. 分页数据拼接</h2><p>6.1 使用数据原生的concat方法合并数组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var a = [1,2];</span><br><span class="line">var b = [3,4,5];</span><br><span class="line">// 把b数组合并到a</span><br><span class="line">a.concat(b)</span><br><span class="line"></span><br><span class="line">console.log(a); // [1,2,3,4,5]</span><br></pre></td></tr></table></figure>
<p>6.2 使用数组的解构</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var a = [...a, ...b];</span><br></pre></td></tr></table></figure>
<h2 id="7-解决页面上保留上一页数据的bug"><a href="#7-解决页面上保留上一页数据的bug" class="headerlink" title="7. 解决页面上保留上一页数据的bug"></a>7. 解决页面上保留上一页数据的bug</h2><p>在onUnLoad里页面卸载卸载初始化data的数据</p>
<p><a href="https://github.com/Meituan-Dianping/mpvue/issues" target="_blank" rel="noopener">https://github.com/Meituan-Dianping/mpvue/issues</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 页面卸载时候触发</span><br><span class="line">onUnload()&#123;</span><br><span class="line">  // 合并对象</span><br><span class="line">  // this.$options.data()获取当前页面组件最初的data</span><br><span class="line">  Object.assign(this, this.$options.data())</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>##8. 代码地址</p>
<p><a href="https://gitee.com/xxxxxxxxxxxxxxxxxxxxxxxxxxx/miniprogram-24" target="_blank" rel="noopener">https://gitee.com/xxxxxxxxxxxxxxxxxxxxxxxxxxx/miniprogram-24</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yugeye.gitee.io/blog/blog/2019/01/16/小程序-mpvue项目搭建以及页面配置/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YuGeYe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yu！">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2019/01/16/小程序-mpvue项目搭建以及页面配置/" itemprop="url">小程序-mpvue项目搭建以及页面配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-16T12:33:25+08:00">
                2019-01-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/小程序/" itemprop="url" rel="index">
                    <span itemprop="name">小程序</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="小程序-1"><a href="#小程序-1" class="headerlink" title="小程序-1"></a>小程序-1</h1><h2 id="1-框架分析"><a href="#1-框架分析" class="headerlink" title="1.框架分析"></a>1.框架分析</h2><ul>
<li>wepy 是由个人开发的，维护和更新不安全</li>
<li>mpvue  好处是美团发起的，并且vue作者贡献代码，但是mpvue开发的小程序需要多一层编译, (对于我们当前学习好处是可以重新做一套vuejs相关的项目)</li>
<li>原生小程序（注意原生小程序的更新，能用原生来开发尽量用原生）</li>
</ul>
<p>##2.搭建mpvue项目</p>
<p>1.统一切换到桌面 例子 : C:\Users\Administrator\Desktop&gt;</p>
<p>2.下载模板 <code>vue init mpvue/mpvue-quickstart shop</code></p>
<p>3.切换到项目目录 <code>cd shop</code></p>
<p>4.安装依赖包 <code>npm install</code></p>
<p>5.启动项目 npm run dev</p>
<p>##3.mpvue项目的结构</p>
<p>1.页面结构是index.vue和main.js组成, main.js是固定写死的，每个页面都存在一个main.js</p>
<p>2.页面的配置是由main.json来配置，但是这个文件不是必须的</p>
<p>3.新建项目需要手动创建，并且在app.json中手动添加pages配置</p>
<p>##4.配置项目的tabbar</p>
<p>把images图片文件夹放到项目shop/static</p>
<p><img src="C:\Users\Administrator\Desktop\课程-广州传智24期小程序阶段-mpvue\day-02\md_images\1546830220189.png" alt="1546830220189"></p>
<p>在app.json新增tabBar配置</p>
<h2 id="5-首页实现"><a href="#5-首页实现" class="headerlink" title="5.首页实现"></a>5.首页实现</h2><p>1.修改全局的配置</p>
<p>2.使用轮播图组件</p>
<p>3.楼层的布局</p>
<p>###1.修改全局的配置</p>
<p><img src="C:\Users\Administrator\Desktop\课程-广州传智24期小程序阶段-mpvue\day-02\md_images\1546842896769.png" alt="1546842896769"></p>
<p>###2.使用轮播图组件</p>
<p><img src="C:\Users\ADMINI~1\AppData\Local\Temp\1546845853393.png" alt="1546845853393"></p>
<h2 id="6-配置request合法域名"><a href="#6-配置request合法域名" class="headerlink" title="6.配置request合法域名"></a>6.配置request合法域名</h2><p>在微信公众平台后台-&gt; 开发 -&gt; 开发设置 添加合法域名 (注意一个月只能修改5次)</p>
<p>配置完成后重启开发工具，在详情-&gt;域名信息可以看到域名就表示配置成功</p>
<p><img src="C:\Users\ADMINI~1\AppData\Local\Temp\1546845986217.png" alt="1546845986217"></p>
<h2 id="7-封装request请求，返回promise对象"><a href="#7-封装request请求，返回promise对象" class="headerlink" title="7.封装request请求，返回promise对象"></a>7.封装request请求，返回promise对象</h2><p>从结果出发，先把你想要的效果先展示出来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">request(参数1， 参数2， 参数3).then(res =&gt; &#123;</span><br><span class="line">    // somthing</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>根据上面的代码进行封装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function request(url, method = &quot;GET&quot;,  data = &#123;&#125;)&#123;</span><br><span class="line">    return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">        wx.request(&#123;</span><br><span class="line">            url,</span><br><span class="line">            method,</span><br><span class="line">            data,</span><br><span class="line">            success: res =&gt; &#123;</span><br><span class="line">                resolve(res);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>需要使用async await解决多层嵌套，使用同步的方法解决多个异步请求</p>
<h2 id="8-async-await的使用"><a href="#8-async-await的使用" class="headerlink" title="8.async await的使用"></a>8.async await的使用</h2><p>在函数前面声明async变量，使该函数变成异步函数，在异步函数里面使用await关键字等待promise请求的返回，await返回的结果是resolve的参数(res)</p>
<p>await在等待执行时候下面代码不会执行</p>
<p><img src="C:\Users\Administrator\Desktop\课程-广州传智24期小程序阶段-mpvue\day-02\md_images\1546852822701.png" alt="1546852822701"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yugeye.gitee.io/blog/blog/2019/01/16/小程序-自定义组件/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YuGeYe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yu！">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2019/01/16/小程序-自定义组件/" itemprop="url">小程序-自定义组件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-16T12:33:04+08:00">
                2019-01-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/小程序/" itemprop="url" rel="index">
                    <span itemprop="name">小程序</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="小程序的自定义组件"><a href="#小程序的自定义组件" class="headerlink" title="小程序的自定义组件"></a>小程序的自定义组件</h2><h3 id="1-1-在vuejs中声明组件的步骤"><a href="#1-1-在vuejs中声明组件的步骤" class="headerlink" title="1.1 在vuejs中声明组件的步骤"></a>1.1 在vuejs中声明组件的步骤</h3><p>1.初始化一个.vue单文件</p>
<p>2.在需要调用组件的页面中使用import导入</p>
<p><code>import xxx from &quot;@components/xxx&quot;</code></p>
<p>3.在页面中注册组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">    components: &#123;</span><br><span class="line">        xxx: xxx</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4.在页面使用</p>
<p><code>&lt;xxx/&gt;</code></p>
<p>###1.2在小程序中声明组件的步骤</p>
<p>1.在开发工具代码中components目录下要右键新建一个文件夹</p>
<p>2.在新建的文件夹中右键选择 <code>新建Component</code></p>
<p>新建完成后生成四个文件，js文件是组件入口文件，有3个默认属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 通过component来注册</span><br><span class="line">Component(&#123;</span><br><span class="line">  // 相当于vue里面的props</span><br><span class="line">  properties: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  // 和页面的data一样</span><br><span class="line">  data: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  // 同vuejs中的方法列表,注意，在页面page中是没有这个方法列表的，方法事件和onLoad同级</span><br><span class="line">  methods: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>3.自定义组件的导入注册</p>
<p>在页面的配置文件中通过usingComponents导入并且注册</p>
<p>代码示例:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;usingComponents&quot;: &#123;</span><br><span class="line">    &quot;order-button&quot;: &quot;../../components/order-button/main&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4.在页面中使用</p>
<p>在页面的使用组件的方法和vuejs是一样的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;order-button/&gt;</span><br></pre></td></tr></table></figure>
<h2 id="2-组件中的props"><a href="#2-组件中的props" class="headerlink" title="2.组件中的props"></a>2.组件中的props</h2><p>2.1定义组件的props</p>
<p>在小程序中，接收props的属性使用properties </p>
<p>代码示例:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">properties: &#123;</span><br><span class="line">    // 付款状态</span><br><span class="line">    payStatus: &#123;</span><br><span class="line">      type: String, // type表示当前属性的类型</span><br><span class="line">      value: &quot;0&quot;	// value表示当前属性的默认值</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
<p>2.2在页面中渲染properties和渲染data的值是一样的，都是通过两个大括号</p>
<p>2.3调用组件传递参数</p>
<p>调用组件传参数和vue中传参数一样，注意在参数里如果用到了动态的值，需要加上两个大括号进行解析</p>
<p>代码示例:</p>
<p><code>&lt;order-button payStatus=&quot;&quot;/&gt;</code></p>
<h2 id="3-自定义组件的事件"><a href="#3-自定义组件的事件" class="headerlink" title="3.自定义组件的事件"></a>3.自定义组件的事件</h2><p>3.1绑定页面事件</p>
<p>通过bindmyEven或者bind：myEvent绑定页面的事件</p>
<p><code>component-tag-name bindmyevent=&quot;onMyEvent&quot; /&gt;</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">  onMyEvent(e) &#123;</span><br><span class="line">    e.detail // 自定义组件触发事件时提供的detail对象</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>5.2触发事件</p>
<p>触发事件需要在组件中先绑定一个点击事件</p>
<p><code>&lt;button bindtap=&quot;onTap&quot;&gt;点击这个按钮将触发“myevent”事件&lt;/button&gt;</code></p>
<p>在点击事件的处理函数中通过 this.triggerEvent来触发</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Component(&#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onTap() &#123;</span><br><span class="line">    	// 触发传递过来的事件</span><br><span class="line">      this.triggerEvent(&apos;myevent&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="4-页面分享"><a href="#4-页面分享" class="headerlink" title="4.页面分享"></a>4.页面分享</h2><p>设置分享按钮的open-type类型</p>
<p><code>&lt;button open-type=&#39;share&#39; class=&quot;share-btn&quot;&gt;分享&lt;/button&gt;</code></p>
<p>在页面的分享事件中自定义分享内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">  onShareAppMessage(res) &#123;</span><br><span class="line">    if (res.from === &apos;button&apos;) &#123;</span><br><span class="line">      // 来自页面内转发按钮</span><br><span class="line">      console.log(res.target)</span><br><span class="line">    &#125;</span><br><span class="line">    return &#123;</span><br><span class="line">      title: &apos;自定义转发标题&apos;,</span><br><span class="line">      path: &apos;/page/user?id=123&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html#%E9%A1%B5%E9%9D%A2%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html#%E9%A1%B5%E9%9D%A2%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yugeye.gitee.io/blog/blog/2019/01/16/小程序-腾讯地图的使用/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YuGeYe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yu！">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2019/01/16/小程序-腾讯地图的使用/" itemprop="url">小程序-腾讯地图的使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-16T12:31:46+08:00">
                2019-01-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/小程序/" itemprop="url" rel="index">
                    <span itemprop="name">小程序</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#腾讯地图的使用:</p>
<p>1.把腾讯地图显示到小程序</p>
<p>2.实现地图的当前用户的定位</p>
<p>3.通过搜索关键字反回附近的信息</p>
<p>4.导航寻路功能</p>
<p>##1.把腾讯地图显示到小程序</p>
<p>文档地址 : <a href="https://lbs.qq.com/qqmap_wx_jssdk/index.html" target="_blank" rel="noopener">https://lbs.qq.com/qqmap_wx_jssdk/index.html</a></p>
<p>1.1 注册腾讯地图的账号，生成key</p>
<p>生成key时候需要勾选上所有的产品,特别是最后一个</p>
<p><img src="images\1547447665580.png" alt="1547447665580"></p>
<p>1.2下载jssdk，可以在当前页面地址中下载</p>
<p>地址：<a href="https://lbs.qq.com/qqmap_wx_jssdk/index.html" target="_blank" rel="noopener">https://lbs.qq.com/qqmap_wx_jssdk/index.html</a></p>
<p>1.3 根据文档的示例调用腾讯地图</p>
<p>1.4 在小程序中使用map组件显示地图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;map</span><br><span class="line">  id=&quot;map&quot;</span><br><span class="line">  longitude=&quot;&#123;&#123;markers.longitude&#125;&#125;&quot;</span><br><span class="line">  latitude=&quot;&#123;&#123;markers.latitude&#125;&#125;&quot;</span><br><span class="line">  markers=&quot;&#123;&#123;markers&#125;&#125;&quot;</span><br><span class="line">  show-location</span><br><span class="line">  class=&quot;map&quot;</span><br><span class="line">&gt;&lt;/map&gt;</span><br><span class="line"></span><br><span class="line">// js</span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    markers: [&#123;</span><br><span class="line">      iconPath: &apos;/resources/others.png&apos;,</span><br><span class="line">      id: 0,</span><br><span class="line">      // latitude: 23.099994,</span><br><span class="line">      // longitude: 113.324520,</span><br><span class="line">      width: 50,</span><br><span class="line">      height: 50</span><br><span class="line">    &#125;],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1.5 配置app.json中的permission字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;pages&quot;:[</span><br><span class="line">    &quot;pages/index/index&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;window&quot;:&#123;</span><br><span class="line">    &quot;backgroundTextStyle&quot;:&quot;light&quot;,</span><br><span class="line">    &quot;navigationBarBackgroundColor&quot;: &quot;#fff&quot;,</span><br><span class="line">    &quot;navigationBarTitleText&quot;: &quot;WeChat&quot;,</span><br><span class="line">    &quot;navigationBarTextStyle&quot;:&quot;black&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;permission&quot;: &#123;</span><br><span class="line">    &quot;scope.userLocation&quot;: &#123;</span><br><span class="line">      &quot;desc&quot;: &quot;xxx&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-实现地图的当前用户的定位"><a href="#2-实现地图的当前用户的定位" class="headerlink" title="2.实现地图的当前用户的定位"></a>2.实现地图的当前用户的定位</h2><p>使用wx.getLocation获取用户当前的经纬度, 把经纬度设置为map组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 获取当前的位置</span><br><span class="line"> wx.getLocation(&#123;</span><br><span class="line">   success: res =&gt; &#123;</span><br><span class="line">     </span><br><span class="line">     // 修改markers的经纬度</span><br><span class="line">     this.setData(&#123;</span><br><span class="line">       markers: &#123;</span><br><span class="line">         ...this.data.markers,</span><br><span class="line">         latitude: res.latitude ,</span><br><span class="line">         longitude: res.longitude </span><br><span class="line">       &#125;</span><br><span class="line">     &#125;)</span><br><span class="line">   &#125;,</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>
<h2 id="3-通过搜索关键字反回附近的信息"><a href="#3-通过搜索关键字反回附近的信息" class="headerlink" title="3.通过搜索关键字反回附近的信息"></a>3.通过搜索关键字反回附近的信息</h2><p>通过sdk实例对象的search方法搜索结果， 拿到列表后显示在页面上，</p>
<p>当前用户点当前的地址时候在地图上进行定位，就是修改markers的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// 点击搜索结果列表</span><br><span class="line">  handleResClick: function(event)&#123;</span><br><span class="line">    // 获取参数</span><br><span class="line">    // item就是当前点击选中的地址对象</span><br><span class="line">    const &#123;item&#125; = event.currentTarget.dataset;</span><br><span class="line"></span><br><span class="line">    // 设置当前点击的地址定位</span><br><span class="line">    this.setData(&#123;</span><br><span class="line">      markers: [&#123;</span><br><span class="line">        iconPath: &apos;/resources/others.png&apos;,</span><br><span class="line">        latitude: item.location.lat,</span><br><span class="line">        longitude: item.location.lng,</span><br><span class="line">        label: &#123;</span><br><span class="line">          content: item.title,</span><br><span class="line">          textAlign: &quot;center&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;],</span><br><span class="line">      searchRes: &#123;&#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-导航寻路功能"><a href="#4-导航寻路功能" class="headerlink" title="4.导航寻路功能"></a>4.导航寻路功能</h2><p>小程序JavascriptSDK，目前暂未提供路线规划能力 ,需要调用网页的方式api，</p>
<p>参考下面的官网文档</p>
<p><a href="https://lbs.qq.com/qqmap_wx_jssdk/method-direction.html" target="_blank" rel="noopener">https://lbs.qq.com/qqmap_wx_jssdk/method-direction.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yugeye.gitee.io/blog/blog/2019/01/16/小程序-数组去重、富文本、图标的使用/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YuGeYe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yu！">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2019/01/16/小程序-数组去重、富文本、图标的使用/" itemprop="url">小程序-数组去重、富文本、图标的使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-16T12:30:33+08:00">
                2019-01-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/小程序/" itemprop="url" rel="index">
                    <span itemprop="name">小程序</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="小程序-3"><a href="#小程序-3" class="headerlink" title="小程序-3"></a>小程序-3</h1><h2 id="1-复习"><a href="#1-复习" class="headerlink" title="1. 复习"></a>1. 复习</h2><p>1.1 通过onLoad生命周期来获取url的参数，onLoad是小程序的生命周期，在mpvue中小程序的生命周期和vue的生命周期可以同时使用</p>
<p>注意： 在使用vue的生命周期能解决问题时候不需要使用小程序的生命周期</p>
<p>1.2 通过什么页面 onReachBottom 页面事件触发上拉触底, 加载下一页内容</p>
<p>加载过程中需要注意： </p>
<ul>
<li>判断上一个请求是否已经请求完成；</li>
<li>是否有更多数据</li>
</ul>
<h2 id="2-商品详情页"><a href="#2-商品详情页" class="headerlink" title="2.商品详情页"></a>2.商品详情页</h2><p>###2.1 阿里图标的使用</p>
<ul>
<li><p>登录阿里图标网站 <a href="https://www.iconfont.cn/" target="_blank" rel="noopener">https://www.iconfont.cn/</a></p>
</li>
<li><p>可以使用github或者微博账号</p>
</li>
<li><p>进入图标管理-我的项目</p>
</li>
<li><p>如果还没项目，需要点击右侧的新建项目图标，新建一个项目</p>
</li>
<li><p>可以去搜索自己想要的图标-选中需要的图标添加入库-在购物车中加入到项目</p>
</li>
<li><p>使用 -&gt; 选中font-class -&gt; 点击复制代码 -&gt; 在浏览器中打开 -&gt; 复制css源码到项目的样式表中</p>
</li>
<li><p>显示 -&gt; 需要同时设置两个class [ iconfont, 图标的class ]， 图标的class可以在阿里图标库点击图标的复制代码按钮</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//收藏图标</span><br><span class="line">&lt;span class=&quot;iconfont icon-shoucang&quot;&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>###2.2 富文本信息的展示</p>
<p>在mpvue中可以直接使用v-html指令来解析富文本</p>
<p>但是，在原生小程序中或者其他框架解析富文本需要依赖一个第三方的库，</p>
<p><a href="https://github.com/icindy/wxParse" target="_blank" rel="noopener">https://github.com/icindy/wxParse</a></p>
<p>###2.3   商品价格保留2位小数点</p>
<p>使用JAVASCRIPT原生的Number对象下tofixed方法</p>
<p>Number(数字).toFixed(2); </p>
<h2 id="3-搜索页"><a href="#3-搜索页" class="headerlink" title="3 搜索页"></a>3 搜索页</h2><p>###3.1 是否显示取消按钮</p>
<p>通过v-model双向数据绑定到data的变量，如果输入框变量有值，就显示取消按钮，如果输入框变量值为空，隐藏取消按钮</p>
<h3 id="3-2-wx-navigateTo-的使用"><a href="#3-2-wx-navigateTo-的使用" class="headerlink" title="3.2  wx.navigateTo 的使用"></a>3.2  wx.navigateTo 的使用</h3><p>注意： wx.navigateTo 不能跳转到tabBar的页面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wx.navigateTo(&#123;</span><br><span class="line">  url: &apos;test?id=1&apos;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="3-3-添加历史搜索列表"><a href="#3-3-添加历史搜索列表" class="headerlink" title="3.3  添加历史搜索列表"></a>3.3  添加历史搜索列表</h3><p>使用wx.setStorageSync存储数据到本地, 注意小程序的本地存储可以存任何类型，包括 array和object</p>
<p>使用wx.getStorageSync 获取本地的数据</p>
<p>使用wx.removeStorageSync 移除指定的数据 (wx.clearStorage会把所有的数据都清除掉)</p>
<p><a href="https://developers.weixin.qq.com/miniprogram/dev/api/wx.getStorageSync.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/api/wx.getStorageSync.html</a></p>
<h3 id="3-4-搜索历史记录的去重"><a href="#3-4-搜索历史记录的去重" class="headerlink" title="3.4 搜索历史记录的去重"></a>3.4 搜索历史记录的去重</h3><p>通过set对象解决数组元素重复,再解构为一个普通数组，再存到本地</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 把当前关键字存储到历史列表</span><br><span class="line">      this.searchList.unshift(this.inputValue);</span><br><span class="line"></span><br><span class="line">      // 把数组转化为set对象，解决数组去重</span><br><span class="line">      // 去完重后，需要转化为普通的数组</span><br><span class="line">      this.searchList = [...new Set(this.searchList)];</span><br><span class="line"></span><br><span class="line">      // 存储到本地</span><br><span class="line">      wx.setStorageSync(&apos;historyData&apos;, this.searchList);</span><br></pre></td></tr></table></figure>
<h2 id="今天代码地址"><a href="#今天代码地址" class="headerlink" title="今天代码地址"></a>今天代码地址</h2><p><a href="https://gitee.com/xxxxxxxxxxxxxxxxxxxxxxxxxxx/miniprogram-24/tags" target="_blank" rel="noopener">https://gitee.com/xxxxxxxxxxxxxxxxxxxxxxxxxxx/miniprogram-24/tags</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yugeye.gitee.io/blog/blog/2018/12/22/同步Vs code配置和插件/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YuGeYe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yu！">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2018/12/22/同步Vs code配置和插件/" itemprop="url">同步Vs code配置与插件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-22T00:02:39+08:00">
                2018-12-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/插件/" itemprop="url" rel="index">
                    <span itemprop="name">插件</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="同步Vs-code配置与插件"><a href="#同步Vs-code配置与插件" class="headerlink" title="同步Vs code配置与插件"></a>同步Vs code配置与插件</h2><h4 id="在其他电脑上配置同样的vs-code配置和插件-我的Token"><a href="#在其他电脑上配置同样的vs-code配置和插件-我的Token" class="headerlink" title="在其他电脑上配置同样的vs_code配置和插件-我的Token"></a>在其他电脑上配置同样的vs_code配置和插件-我的Token</h4><ul>
<li>Token：3e39606cb309bc521c2fdf03a28e2e702b3c4e5d </li>
</ul>
<h4 id="vscode中的插件Settings-Sync（设置和插件同步）基本用法"><a href="#vscode中的插件Settings-Sync（设置和插件同步）基本用法" class="headerlink" title="vscode中的插件Settings Sync（设置和插件同步）基本用法"></a>vscode中的插件Settings Sync（设置和插件同步）基本用法</h4><ul>
<li>原文链接 <a href="https://blog.csdn.net/small_trees/article/details/79185942" target="_blank" rel="noopener">https://blog.csdn.net/small_trees/article/details/79185942</a></li>
<li>1、Settings Sync是vscode中同步设置和安装插件的小工具，在扩展商店中搜索并安装它 </li>
<li>2、登陆Github&gt;Your profile&gt; settings&gt;Developer settings&gt;personal access tokens&gt;generate new token，输入名称，勾选Gist，提交 </li>
<li>3、保存Github Access Token </li>
<li>4、打开vscode，Ctrl+Shift+P打开命令框，输入sync，找到update/upload settings，输入Token，上传成功后会返回Gist ID，保存此Gist ID. </li>
<li>5、若需在其他机器上DownLoad插件的话，同样，Ctrl+Shift+P打开命令框，输入sync，找到Download settings，会跳转到Github的Token编辑界面，点Edit，regenerate token，保存新生成的token，在vscode命令框中输入此Token，回车，再输入之前的Gist ID，即可同步插件和设置。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/blog/page/2/">2</a><a class="extend next" rel="next" href="/blog/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/blog/uploads/avatar.jpg" alt="YuGeYe">
            
              <p class="site-author-name" itemprop="name">YuGeYe</p>
              <p class="site-description motion-element" itemprop="description">兄dei.你来了!</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/blog/archives/">
              
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/blog/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/blog/tags/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/yourname" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://juejin.im/timeline" target="_blank" title="掘金">
                      
                        <i class="fa fa-fw fa-globe"></i>掘金</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://gitee.com/" target="_blank" title="码云">
                      
                        <i class="fa fa-fw fa-globe"></i>码云</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://blog.csdn.net/nav/watchers" target="_blank" title="CSDN">
                      
                        <i class="fa fa-fw fa-globe"></i>CSDN</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友链
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://uksir.gitee.io/docs/" title="wanshao" target="_blank">wanshao</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://wangdoc.com/javascript/" title="阮一峰" target="_blank">阮一峰</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.liaoxuefeng.com/" title="廖雪峰" target="_blank">廖雪峰</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.zhangxinxu.com/" title="张鑫旭" target="_blank">张鑫旭</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YuGeYe</span>

  
</div>


  <!--<div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>
-->




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  









  
  
    <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/three/three-waves.min.js"></script>
  


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/blog/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/blog/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
